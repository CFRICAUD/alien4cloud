# contains mapping definitions for the various tosca types.

definition:
  # name of the type in java
  java_type: alien4cloud.tosca.model.ArchiveRoot
  # fields to be mapped based on their names.
  named_mapping:
    tosca_definitions_version: archive.toscaDefinitionsVersion

    tosca_default_namespace: archive.toscaDefaultNamespace

    template_name: archive.name

    template_author: archive.templateAuthor

    template_version: archive.version

    description: archive.description

    imports:
      set:
        mapping: archive.dependencies
        type: import_definition

    node_types:
      map:
        key: elementId
        type: node_type
        mapping: nodeTypes

    capability_types:
      map:
        key: elementId
        type: capability_type
        mapping: capabilityTypes

    relationship_types:
      map:
        key: elementId
        type: relationship_type
        mapping: relationshipTypes

    artifact_types:
      map:
        key: elementId
        type: artifact_type
        mapping: artifactTypes

    # inputs:
    # node_templates:
    # relationship_templates:
    # groups:
    # outputs:

import_definition: alien4cloud.tosca.parser.impl.advanced.ImportParser

attribute_definition:
  java_type: alien4cloud.tosca.model.AttributeDefinition
  named_mapping:
    description: description
    type: type
    default: default

capability_definition:
  java_type: alien4cloud.tosca.model.CapabilityDefinition
  named_mapping:
    description: description
    type:
      type: capability_type_reference
      mapping: type
    upper_bound:
      type: bound
      mapping: upperBound
    properties:
      map:
        type: property_value
        mapping: properties

deployment_artifact:
  java_type: alien4cloud.tosca.container.model.template.DeploymentArtifact
  position_mapping:
    0: artifactRef
  named_mapping:
    description: description
    type:
      type: artifact_type_reference
      mapping: type
    mimeType: mimeType

property_value:
  java_type: alien4cloud.tosca.model.ScalarPropertyValue
  named_mapping: value

tosca_function:
  java_type: alien4cloud.tosca.model.FunctionPropertyValue
  position_mapping:
    0:
      key: function
      value:
        list:
          type: scalar
          mapping: parameters

operation_definition:
  java_type: alien4cloud.tosca.model.Operation
  implementation: implementation_artifact
  description: description
  inputs:
    discriminator:
      keys:
        type: property_definition
        get_input: tosca_function
        get_property: tosca_function
        get_attribute: tosca_function
        get_operation_output: tosca_function
      default: property_value
      mapping: inputParameters

node_type:
  java_type: alien4cloud.component.model.IndexedNodeType
  named_mapping:
    description: description
    tags:
      type: tag
      mapping: tags
    abstract: abstract
    derived_from:
      type: derived_from
      mapping: derivedFrom
    properties:
      map:
        type: property_definition
        mapping: properties
        validated: true
    attributes:
      map:
        type: attribute_definition
        mapping: attributes
    requirements:
      map:
        key: id
        type: requirement_definition
        mapping: requirements
    capabilities:
      map:
        key: id
        type: capability_definition
        mapping: capabilities
    interfaces:
      type: interfaces
    artifacts:
      sequence_to_map:
        type: deployment_artifact
        mapping: artifacts

capability_type:
  java_type: alien4cloud.component.model.IndexedCapabilityType
  named_mapping:
    description: description
    tags:
      type: tag
      mapping: tags
    abstract: abstract
    derived_from:
      type: derived_from
      mapping: derivedFrom
    properties:
      map:
        type: property_definition
        mapping: properties
        validated: true

relationship_type:
  java_type:


artifact_type:
  java_type: alien4cloud.component.model.IndexedArtifactType
  named_mapping:
    description: description
    tags:
      type: tag
      mapping: tags
    abstract: abstract
    derived_from:
      type: derived_from
      mapping: derivedFrom
    properties:
      map:
        type: property_definition
        validated: true
        mapping: properties
    mime_type: mimeType
    file_ext:
      list:
        type: scalar
        mapping: fileExt
